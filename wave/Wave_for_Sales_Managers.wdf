{"nodes":{"Extract_PricebookEntry":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Product2Id"}],"object":"PricebookEntry","runtime":{"SFDCtoken":"SFDCtoken"}}},"Extract_Opportunity":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"AccountId"},{"name":"OwnerId"},{"name":"Name"},{"name":"StageName"},{"name":"Opportunity_Source__c"},{"name":"IsWon"},{"name":"Type"},{"name":"IsClosed"},{"name":"ForecastCategory"},{"name":"ForecastCategoryName"},{"fiscalMonthOffset":0,"name":"CreatedDate"},{"fiscalMonthOffset":0,"name":"CloseDate"},{"name":"Amount"},{"name":"CreatedById"}],"object":"Opportunity","runtime":{"SFDCtoken":"SFDCtoken"}}},"Extract_OpportunityAmount":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Amount"}],"object":"Opportunity","runtime":{"SFDCtoken":"SFDCtoken"}}},"Extract_Product":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"ProductCode"},{"name":"Name"},{"name":"Family"}],"object":"Product2","runtime":{"SFDCtoken":"SFDCtoken"}}},"Extract_User":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Username"},{"name":"Name"},{"name":"FirstName"},{"name":"LastName"},{"name":"UserRoleId"},{"name":"IsActive"}],"object":"User","runtime":{"SFDCtoken":"SFDCtoken"}}},"Join_TaskOwner_Product_Opp":{"action":"augment","parameters":{"leftKey":["WhatId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Id","Name","Type","OwnerId","IsWon","IsClosed","AccountId","CloseDate","StageName","CreatedDate","Opportunity_Source__c","ForecastCategoryName","Account.Name","Account.Segment__c","Account.Industry","Account.Type","Account.BillingCountry","Account.BillingState","Account.OwnerId"]},"sources":["Join_TaskOwner_Product","Join_OpportunityOwner"]},"Extract_OpportunityStage":{"action":"sobjectDigest","parameters":{"fields":[{"name":"IsClosed"},{"fiscalMonthOffset":0,"name":"CreatedDate"},{"name":"Description"},{"name":"ForecastCategory"},{"name":"ForecastCategoryName"},{"name":"IsActive"},{"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"MasterLabel"},{"name":"Id"},{"name":"DefaultProbability"},{"name":"SortOrder"},{"name":"SystemModstamp"},{"name":"IsWon"}],"object":"OpportunityStage"}},"Join_OpportunityStage_Previous_with_Opp":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Name","Type","IsWon","IsClosed","OwnerId","AccountId","CloseDate","StageName","Opportunity_Source__c","ForecastCategoryName","Account.Name","Account.Segment__c","Account.Industry","Account.Type","Account.BillingState","Account.BillingCountry","Account.OwnerId","Owner.Name","Owner.RoleNames","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath"]},"sources":["Join_OpportunityStage_Previous","Join_OpportunityOwner"]},"Join_OpportunityStage_Previous_with_Opp_Amount":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Amount"]},"sources":["Join_OpportunityStage_Previous_with_Opp","Extract_OpportunityAmount"]},"Register_PlainQuota":{"action":"register","parameters":{"label":"Quota","name":"plain_quota1","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Extract_Quota"]},"Join_OpportunityLineItemPricebookEntryProduct":{"action":"augment","parameters":{"leftKey":["Pricebook.Product2Id"],"relationship":"Product","rightKey":["Id"],"rightSelect":["ProductCode","Name","Family"]},"sources":["Join_OpportunityLineItemPricebookEntry","Extract_Product"]},"Join_TaskOwner_Product_Opp_User":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"AssignedTo","rightKey":["Id"],"rightSelect":["Name"]},"sources":["Join_TaskOwner_Product_Opp","Filter_User"]},"Register_Task":{"action":"register","parameters":{"label":"Task","name":"task1","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_TaskOwner_Product_Opp_User"]},"Register_OpportunityProducts":{"action":"register","parameters":{"label":"Oppty Products","name":"opportunity_products1","rowLevelSecurityFilter":"'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Register_UserManager":{"action":"register","parameters":{"label":"User Manager","name":"user1","rowLevelSecurityFilter":"'Role.Roles' == \"$User.UserRoleId\" || 'Id' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Flatten_UserRoleNames"]},"Join_OpportunityStage":{"action":"augment","parameters":{"leftKey":["StageName"],"relationship":"Stage","rightKey":["MasterLabel"],"rightSelect":["IsClosed","IsWon"]},"sources":["Flag_For_Days_in_Current_Stage","Extract_OpportunityStage"]},"Join_EventOwner_Product_Opp_User":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"AssignedTo","rightKey":["Id"],"rightSelect":["Name"]},"sources":["Join_EventOwner_Product_Opp","Extract_User"]},"Register_UserRole":{"action":"register","parameters":{"label":"User Role","name":"user_role1","rowLevelSecurityFilter":"'Id' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Flatten_UserRoleNames"]},"Join_EventOwner_Product":{"action":"augment","parameters":{"leftKey":["WhatId"],"operation":"LookupMultiValue","relationship":"Opportunity","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_EventOwner","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"computeTrending":{"action":"computeRelative","parameters":{"computedFields":[{"description":"Opportunity Created Date","expression":{"sourceField":"CreatedDate","offset":"first()","default":"current()"},"label":"OpportunityCreatedDate","name":"OpportunityCreatedDate"},{"description":"ValidToDate","expression":{"sourceField":"CreatedDate","offset":"next()","default":"3000-01-01T00:00:00.000Z"},"label":"ValidToDate","name":"ValidToDate"},{"description":"ValidFromDate","expression":{"sourceField":"CreatedDate","offset":"current()","default":"current()"},"label":"ValidFromDate","name":"ValidFromDate"},{"description":"AmountPrev","expression":{"sourceField":"Amount__c","offset":"previous()","default":"0"},"label":"AmountPrev","name":"AmountPrev"},{"description":"Previous Stage Name","expression":{"sourceField":"StageName__c","offset":"previous()","default":null},"label":"Prev Stage Name","name":"StageNamePrev"},{"description":"ForecastCategoryPrev","expression":{"sourceField":"ForecastCategory__c","offset":"previous()","default":null},"label":"ForecastCategoryPrev","name":"ForecastCategoryPrev"},{"description":"Previous Close Date","expression":{"sourceField":"CloseDate__c","offset":"previous()","default":"1970-01-01"},"label":"Prev Close Date","name":"CloseDatePrev"},{"description":"Previous Created Date","expression":{"sourceField":"CreatedDate","offset":"previous()","default":"1970-01-01T00:00:00.000Z"},"label":"Prev CreatedDate","name":"CreatedDatePrev"},{"expression":{"sourceField":"ForecastCategory__c","offset":"current()","default":null},"label":"To ForecastCategory","name":"ForecastCategory"},{"expression":{"sourceField":"Amount__c","offset":"current()","default":"0"},"label":"Amount","name":"Amount"},{"expression":{"sourceField":"CloseDate__c","offset":"current()","default":"current()"},"label":"Close Date","name":"CloseDate"},{"expression":{"sourceField":"OpportunityId__c","offset":"current()","default":"current()"},"label":"Opportunity ID","name":"OpportunityId"},{"expression":{"sourceField":"StageName__c","offset":"current()","default":null},"label":"Stage Name","name":"StageName"}],"orderBy":[{"direction":"asc","name":"CreatedDate"}],"partitionBy":["OpportunityId__c"]},"sources":["Extract_OpportunityHistory"]},"Extract_OpportunityHistory":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Amount__c"},{"fiscalMonthOffset":0,"name":"CloseDate__c"},{"name":"CreatedById"},{"fiscalMonthOffset":0,"name":"CreatedDate"},{"name":"ForecastCategory__c"},{"name":"Id"},{"name":"IsDeleted"},{"name":"OpportunityId__c"},{"name":"StageName__c"}],"object":"OpportunityHistory__c"}},"Flatten_UserRoleNames":{"action":"flatten","parameters":{"multiField":{"isSystemField":false,"label":"RoleNames","name":"RoleNames"},"parentField":"ParentRole.DeveloperName","pathField":{"isSystemField":false,"label":"RoleNamesPath","name":"RoleNamesPath"},"selfField":"Role.DeveloperName"},"sources":["User_with_Roles_ParentName"]},"Extract_OpportunityLineItem":{"action":"sobjectDigest","parameters":{"fields":[{"name":"OpportunityId"},{"name":"ProductCode"},{"name":"ListPrice"},{"name":"Quantity"},{"name":"TotalPrice"},{"name":"PricebookEntryId"}],"object":"OpportunityLineItem","runtime":{"SFDCtoken":"SFDCtoken"}}},"Register_Pipeline_Trending":{"action":"register","parameters":{"label":"Pipeline Trending","name":"pipeline_trending1","rowLevelSecurityFilter":"'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\""},"sources":["Join_OpportunityStage_Previous_with_Opp_Amount_Product"]},"Discount_Field":{"action":"computeExpression","parameters":{"computedFields":[{"name":"Discount_Percent","precision":7,"saqlExpression":"1-(('TotalPrice')/('ListPrice' * 'Quantity'))","scale":6,"type":"Numeric"}],"mergeWithSource":true},"sources":["Extract_OpportunityLineItem"]},"Register_Opportunity":{"action":"register","parameters":{"label":"Opportunities","name":"opportunity1","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_OpportunityOwner_Product"]},"Join_OpportunityLineItemPricebookEntry":{"action":"augment","parameters":{"leftKey":["PricebookEntryId"],"relationship":"Pricebook","rightKey":["Id"],"rightSelect":["Product2Id"]},"sources":["Discount_Field","Extract_PricebookEntry"]},"Join_AccountOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","RoleNames","RoleNamesPath"]},"sources":["Extract_Account","Flatten_UserRoleNames"]},"Extract_Task":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"CallDurationInSeconds"},{"name":"CallDisposition"},{"name":"CallType"},{"name":"OwnerId"},{"name":"Status"},{"name":"Priority"},{"name":"IsClosed"},{"name":"TaskSubtype"},{"fiscalMonthOffset":0,"name":"CreatedDate"},{"fiscalMonthOffset":0,"name":"ActivityDate"},{"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"Subject"},{"name":"WhatId"},{"name":"AccountId"}],"object":"Task","passthroughFilter":"CreatedDate >= LAST_N_DAYS:730"}},"Join_EventOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","RoleNames","RoleNamesPath"]},"sources":["Extract_Event","Flatten_UserRoleNames"]},"Join_OpportunityOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","RoleNames","RoleNamesPath"]},"sources":["Join_OpportunityAccount","Flatten_UserRoleNames"]},"Register_QuotaWithRoles":{"action":"register","parameters":{"label":"Quota User Manager","name":"quota1","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_Quota_User"]},"Join_OpportunityAccount":{"action":"augment","parameters":{"leftKey":["AccountId"],"relationship":"Account","rightKey":["Id"],"rightSelect":["Name","Segment__c","Industry","BillingCountry","BillingState","Type","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"]},"sources":["Extract_Opportunity","Join_AccountOwner"]},"Join_EventOwner_Product_Opp":{"action":"augment","parameters":{"leftKey":["WhatId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Id","Name","Type","OwnerId","IsWon","IsClosed","AccountId","CloseDate","StageName","CreatedDate","Opportunity_Source__c","ForecastCategoryName","Account.Name","Account.Segment__c","Account.Industry","Account.Type","Account.BillingCountry","Account.BillingState","Account.OwnerId"]},"sources":["Join_EventOwner_Product","Join_OpportunityOwner"]},"Filter_User":{"action":"filter","parameters":{"filter":"IsActive:EQ:true|false"},"sources":["Extract_User"]},"Join_TaskOwner_Product":{"action":"augment","parameters":{"leftKey":["WhatId"],"operation":"LookupMultiValue","relationship":"Opportunity","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_TaskOwner","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Join_OpportunityStage_Previous_with_Opp_Amount_Product":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"operation":"LookupMultiValue","relationship":"Opportunity","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_OpportunityStage_Previous_with_Opp_Amount","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Flag_For_Days_in_Current_Stage":{"action":"computeExpression","parameters":{"computedFields":[{"defaultValue":"\"1\"","name":"Stage_isUpdated","saqlExpression":"case when 'StageName' == 'StageNamePrev' then \"0\" else \"1\" end","type":"Text"},{"defaultValue":"\"1\"","name":"CloseDate_isUpdated","saqlExpression":"case when 'CloseDatePrev' == 'CloseDate' then \"0\" else \"1\" end","type":"Text"}],"mergeWithSource":true},"sources":["Extract_OpportunityHistory"]},"Join_Quota_User":{"action":"augment","parameters":{"leftKey":["Username"],"relationship":"User","rightKey":["Username"],"rightSelect":["Id","Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","RoleNames","RoleNamesPath"]},"sources":["Extract_Quota","Flatten_UserRoleNames"]},"Extract_Account":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Name"},{"name":"OwnerId"},{"name":"Type"},{"name":"Segment__c"},{"name":"Industry"},{"name":"BillingCountry"},{"name":"BillingState"},{"fiscalMonthOffset":0,"name":"CreatedDate"},{"fiscalMonthOffset":0,"name":"LastModifiedDate"}],"object":"Account","runtime":{"SFDCtoken":"SFDCtoken"}}},"Join_TaskOwner":{"action":"augment","parameters":{"leftKey":["OwnerId"],"relationship":"Owner","rightKey":["Id"],"rightSelect":["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","RoleNames","RoleNamesPath"]},"sources":["Extract_Task","Flatten_UserRoleNames"]},"Join_OpportunityOpportunityLineItemPricebookEntryProduct":{"action":"augment","parameters":{"leftKey":["OpportunityId"],"relationship":"Opportunity","rightKey":["Id"],"rightSelect":["Name","StageName","CloseDate","IsWon","Type","IsClosed","Opportunity_Source__c","ForecastCategory","ForecastCategoryName","CreatedDate","AccountId","Account.Name","Account.OwnerId","Account.Segment__c","Account.Industry","Account.BillingCountry","Account.BillingState","Account.Type","Account.Owner.Name","Account.Owner.Role.Name","Account.Owner.Role.Roles","Account.Owner.Role.RolePath","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"]},"sources":["Join_OpportunityLineItemPricebookEntryProduct","Join_OpportunityOwner"]},"User_with_Roles_ParentName":{"action":"augment","parameters":{"leftKey":["Role.ParentRoleId"],"relationship":"ParentRole","rightKey":["Id"],"rightSelect":["Name","DeveloperName"]},"sources":["User_with_Roles","Extract_UserRole"]},"Extract_Quota":{"action":"dataset","parameters":{"name":"plain_quota1"}},"User_with_Roles":{"action":"augment","parameters":{"leftKey":["UserRoleId"],"relationship":"Role","rightKey":["Id"],"rightSelect":["Name","DeveloperName","Roles","RolePath","ParentRoleId"]},"sources":["Filter_User","Flatten_UserRole"]},"Extract_UserRole":{"action":"sobjectDigest","parameters":{"fields":[{"name":"Id"},{"name":"Name"},{"name":"DeveloperName"},{"name":"ParentRoleId"},{"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"name":"LastModifiedById"},{"name":"SystemModstamp"}],"object":"UserRole","runtime":{"SFDCtoken":"SFDCtoken"}}},"Join_OpportunityOwner_Product":{"action":"augment","parameters":{"leftKey":["Id"],"operation":"LookupMultiValue","relationship":"Product","rightKey":["OpportunityId"],"rightSelect":["Product.Family","Product.Name"]},"sources":["Join_OpportunityOwner","Join_OpportunityOpportunityLineItemPricebookEntryProduct"]},"Flatten_UserRole":{"action":"flatten","parameters":{"multiField":{"isSystemField":false,"label":"Roles","name":"Roles"},"parentField":"ParentRoleId","pathField":{"isSystemField":false,"label":"RolePath","name":"RolePath"},"selfField":"Id"},"sources":["Extract_UserRole"]},"Extract_Event":{"action":"sobjectDigest","parameters":{"fields":[{"name":"OwnerId"},{"fiscalMonthOffset":0,"name":"CreatedDate"},{"fiscalMonthOffset":0,"name":"LastModifiedDate"},{"fiscalMonthOffset":0,"name":"ActivityDate"},{"name":"Subject"},{"name":"DurationInMinutes"},{"name":"EventSubtype"},{"name":"WhatId"},{"name":"AccountId"}],"object":"Event","passthroughFilter":"CreatedDate >= LAST_N_DAYS:730"}},"Join_OpportunityStage_Previous":{"action":"augment","parameters":{"leftKey":["StageNamePrev"],"relationship":"StagePrev","rightKey":["MasterLabel"],"rightSelect":["IsClosed","IsWon"]},"sources":["Join_OpportunityStage","Extract_OpportunityStage"]},"Register_Event":{"action":"register","parameters":{"label":"Event","name":"event1","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","runtime":{"SFDCtoken":"SFDCtoken"}},"sources":["Join_EventOwner_Product_Opp_User"]}}}